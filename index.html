<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>QuickGlass Calc</title>
  <meta name="theme-color" content="#0b1220" />

  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#1b2a4a;
      --glass: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.18);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --radius-xl: 28px;
      --radius-lg: 22px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui;
      color:var(--text);
      background:
        radial-gradient(1000px 700px at 20% 10%, rgba(139,59,255,.35), transparent 60%),
        radial-gradient(1000px 700px at 80% 0%, rgba(35,213,171,.25), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    .wrap{
      max-width:900px;
      margin:auto;
      padding:16px;
      padding-bottom:40px;
    }

    h1{
      margin:8px 0 2px;
      font-size:28px;
      font-weight:800;
    }
    .subtitle{
      font-size:13px;
      color:var(--muted);
      margin-bottom:14px;
    }

    .panel{
      background:var(--glass);
      border:1px solid var(--stroke);
      border-radius:var(--radius-xl);
      backdrop-filter:blur(16px);
      padding:16px;
    }

    /* ===== TOTAL ===== */
    .summary{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-bottom:16px;
    }

    .sum-label{
      display:flex;
      justify-content:space-between;
      font-size:12px;
      color:var(--muted);
      font-weight:700;
      letter-spacing:.06em;
      text-transform:uppercase;
    }

    .total{
      font-size:clamp(38px,10vw,52px);
      font-weight:900;
      line-height:1.05;
    }

    .chips{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    .chip{
      height:34px;
      padding:0 14px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.18);
      backdrop-filter:blur(12px);
      font-size:12px;
      font-weight:700;
      color:var(--text);
    }
    .chip.danger{
      background:rgba(255,90,95,.22);
      border-color:rgba(255,90,95,.35);
    }
    .chip:active{ transform:scale(.97); }

    /* ===== GRID ===== */
    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }

    .tile{
      background:rgba(255,255,255,.1);
      border:1px solid var(--stroke);
      border-radius:var(--radius-lg);
      padding:14px;
      backdrop-filter:blur(14px);
      display:flex;
      flex-direction:column;
      gap:12px;
      position:relative;
    }

    .tile-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .amount{
      font-size:22px;
      font-weight:900;
    }

    .count{
      font-size:13px;
      font-weight:800;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(0,0,0,.18);
    }

    .controls{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }

    .mini{
      height:54px;
      border-radius:18px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      color:var(--text);
      font-size:22px;
      font-weight:900;
    }
    .mini:active{ transform:scale(.97); }

    /* delete badge */
    .delete{
      position:absolute;
      top:10px;
      left:10px;
      width:32px;
      height:32px;
      border-radius:50%;
      background:rgba(255,90,95,.35);
      border:1px solid rgba(255,90,95,.5);
      color:white;
      font-weight:900;
      display:none;
    }

    .edit .delete{ display:flex; align-items:center; justify-content:center; }

  </style>
</head>

<body>
  <div class="wrap" id="app">
    <h1>QuickGlass Calc</h1>
    <div class="subtitle">Sumá servicios con botones (+ / −)</div>

    <section class="panel summary">
      <div class="sum-label">
        <span>Total</span>
        <span id="touches">0 toques</span>
      </div>
      <div class="total" id="total">$0</div>
      <div class="chips">
        <button class="chip" id="addBtn">+ Nuevo botón</button>
        <button class="chip danger" id="resetBtn">Reiniciar</button>
      </div>
    </section>

    <div class="grid" id="grid"></div>
  </div>

  <script>
    let buttons = [
      {id:1, amount:12000},
      {id:2, amount:15000},
      {id:3, amount:20000},
      {id:4, amount:8000},
      {id:5, amount:2000}
    ];
    let counts = {};
    let edit=false;
    let audioCtx;

    function sound(){
      try{
        if(!audioCtx) audioCtx=new AudioContext();
        const o=audioCtx.createOscillator();
        const g=audioCtx.createGain();
        o.frequency.value=900;
        g.gain.value=0.08;
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime+0.03);
      }catch{}
      if(navigator.vibrate) navigator.vibrate(10);
    }

    function format(n){
      return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",maximumFractionDigits:0}).format(n);
    }

    function render(){
      const grid=document.getElementById("grid");
      grid.innerHTML="";
      let total=0, t=0;

      buttons.forEach(b=>{
        counts[b.id]=counts[b.id]||0;
        total+=b.amount*counts[b.id];
        t+=counts[b.id];

        const d=document.createElement("div");
        d.className="tile"+(edit?" edit":"");
        d.innerHTML=`
          <button class="delete">×</button>
          <div class="tile-top">
            <div class="amount">${format(b.amount)}</div>
            <div class="count">x ${counts[b.id]}</div>
          </div>
          <div class="controls">
            <button class="mini">−</button>
            <button class="mini">+</button>
          </div>
        `;
        d.querySelectorAll(".mini")[0].onclick=()=>{ if(!edit){ sound(); counts[b.id]--; if(counts[b.id]<0)counts[b.id]=0; render();}};
        d.querySelectorAll(".mini")[1].onclick=()=>{ if(!edit){ sound(); counts[b.id]++; render();}};
        d.querySelector(".delete").onclick=()=>{ if(edit){ buttons=buttons.filter(x=>x.id!==b.id); render();}};
        d.oncontextmenu=e=>e.preventDefault();
        d.ontouchstart=()=>{ setTimeout(()=>{ edit=true; render(); },500); };

        grid.appendChild(d);
      });

      document.getElementById("total").textContent=format(total);
      document.getElementById("touches").textContent=t+" toques";
    }

    document.getElementById("resetBtn").onclick=()=>{
      sound();
      buttons.forEach(b=>counts[b.id]=0);
      render();
    };

    document.getElementById("addBtn").onclick=()=>{
      sound();
      const v=prompt("Monto:");
      if(v){
        buttons.unshift({id:Date.now(),amount:parseInt(v)});
        render();
      }
    };

    render();
  </script>
</body>
</html>
